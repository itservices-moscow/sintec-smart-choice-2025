document.addEventListener("DOMContentLoaded", () => {
  !(function () {
      let e = new Image();
      (e.onload = e.onerror = function () {
          let t = 2 === e.height;
          document.documentElement.classList.add(t ? "webp" : "no-webp");
      }),
          (e.src = "data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA");
  })();
  let e = document.querySelector(".header"),
      t = document.querySelector(".menu"),
      l = document.querySelector(".header__burger-icon");
  t &&
      l &&
      l.addEventListener("click", () => {
          V(t), V(e), V(l);
      });
  let i = document.querySelectorAll("[data-goto]");
  if (i.length > 0) {
      i.forEach((e) => {
          e.addEventListener("click", o);
      });
      function o(i) {
          let o = i.target;
          if (o.dataset.goto && document.querySelector(o.dataset.goto)) {
              let s = document.querySelector(o.dataset.goto),
                  n = s.getBoundingClientRect().top + window.pageYOffset;
              window.scrollTo({ top: n, behavior: "smooth" }), i.preventDefault(), t.classList.contains("_active") && (F(t), F(e), F(l));
          }
      }
  }
  let s = document.querySelectorAll("._anim-items");
  if (s.length > 0) {
      function n() {
          s.forEach((e) => {
              let t = e.offsetHeight,
                  l = r(e).top,
                  i = window.innerHeight - t / 4;
              window.pageYOffset > l - i && window.pageYOffset < l + t ? e.classList.add("_visible") : e.classList.contains("_anim-no-hide") || e.classList.remove("_visible");
          });
      }
      function r(e) {
          let t = e.getBoundingClientRect();
          return { top: t.top + window.pageYOffset, left: t.left + window.pageXOffset };
      }
      window.addEventListener("scroll", n), setTimeout(n, 200);
  }
  let a = document.querySelectorAll("[data-spollers]");
  if (a.length > 0) {
      let c = Array.from(a).filter(function (e, t, l) {
          return !e.dataset.spollers.split(",")[0];
      });
      c.length > 0 && u(c);
      let d = Array.from(a).filter(function (e, t, l) {
          return e.dataset.spollers.split(",")[0];
      });
      if (d.length > 0) {
          let p = [];
          d.forEach((e) => {
              let t = e.dataset.spollers,
                  l = {},
                  i = t.split(",");
              (l.value = i[0]), (l.type = i[1] ? i[1].trim() : "max"), (l.item = e), p.push(l);
          });
          let h = p.map(function (e) {
              return "(" + e.type + "-width:" + e.value + "px)," + e.value + "," + e.type;
          });
          (h = h.filter(function (e, t, l) {
              return l.indexOf(e) === t;
          })).forEach((e) => {
              let t = e.split(","),
                  l = t[1],
                  i = t[2],
                  o = window.matchMedia(t[0]),
                  s = p.filter(function (e) {
                      if (e.value === l && e.type === i) return !0;
                  });
              o.addListener(function () {
                  u(s, o);
              }),
                  u(s, o);
          });
      }
      function u(e, t = !1) {
          e.forEach((e) => {
              (e = t ? e.item : e), t.matches || !t ? (e.classList.add("_init"), y(e), e.addEventListener("click", g)) : (e.classList.remove("_init"), y(e, !1), e.removeEventListener("click", g));
          });
      }
      function y(e, t = !0) {
          let l = e.querySelectorAll("[data-spoller]");
          l.length > 0 &&
              l.forEach((e) => {
                  t ? (e.removeAttribute("tabindex"), e.classList.contains("_active") || (e.nextElementSibling.hidden = !0)) : (e.setAttribute("tabindex", "-1"), (e.nextElementSibling.hidden = !1));
              });
      }
      function g(e) {
          let t = e.target;
          if (t.hasAttribute("data-spoller") || t.closest("[data-spoller]")) {
              let l = t.hasAttribute("data-spoller") ? t : t.closest("[data-spoller]"),
                  i = l.closest("[data-spollers]"),
                  o = !!i.hasAttribute("data-one-spoller");
              i.querySelectorAll("._slide").length || (o && !l.classList.contains("_active") && $(i), l.parentElement.classList.toggle("_active"), l.classList.toggle("_active"), v(l.nextElementSibling, 900)), e.preventDefault();
          }
      }
      function $(e) {
          let t = e.querySelector("[data-spoller]._active");
          t && (t.classList.remove("_active"), f(t.nextElementSibling, 900));
      }
  }
  let f = (e, t = 900) => {
          e.classList.contains("_slide") ||
              (e.classList.add("_slide"),
              (e.style.transitionProperty = "height, margin, padding"),
              (e.style.transitionDuration = t + "ms"),
              (e.style.height = e.offsetHeight + "px"),
              e.offsetHeight,
              (e.style.overflow = "hidden"),
              (e.style.height = 0),
              (e.style.paddingTop = 0),
              (e.style.paddingBottom = 0),
              (e.style.marginTop = 0),
              (e.style.marginBottom = 0),
              window.setTimeout(() => {
                  (e.hidden = !0),
                      e.style.removeProperty("height"),
                      e.style.removeProperty("padding-top"),
                      e.style.removeProperty("padding-bottom"),
                      e.style.removeProperty("mragin-top"),
                      e.style.removeProperty("margin-bottom"),
                      e.style.removeProperty("overflow"),
                      e.style.removeProperty("transition-duration"),
                      e.style.removeProperty("transition-property"),
                      e.classList.remove("_slide");
              }, t));
      },
      m = (e, t = 900) => {
          if (!e.classList.contains("_slide")) {
              e.classList.add("_slide"), e.hidden && (e.hidden = !1);
              let l = e.offsetHeight;
              (e.style.overflow = "hidden"),
                  (e.style.height = 0),
                  (e.style.paddingTop = 0),
                  (e.style.paddingBottom = 0),
                  (e.style.marginTop = 0),
                  (e.style.marginBottom = 0),
                  e.offsetHeight,
                  (e.style.transitionProperty = "height, margin, padding"),
                  (e.style.transitionDuration = t + "ms"),
                  (e.style.height = l + "px"),
                  e.style.removeProperty("padding-top"),
                  e.style.removeProperty("padding-bottom"),
                  e.style.removeProperty("margin-top"),
                  e.style.removeProperty("margin-bottom"),
                  window.setTimeout(() => {
                      e.style.removeProperty("height"), e.style.removeProperty("overflow"), e.style.removeProperty("transition-duration"), e.style.removeProperty("transition-property"), e.classList.remove("_slide");
                  }, t);
          }
      },
      v = (e, t = 900) => (e.hidden ? m(e, t) : f(e, t));
  document.querySelectorAll(".technologies-item").forEach((e) => {
      let t = e.querySelector(".technologies-item__text"),
          l = e.querySelector(".technologies-item-product"),
          i = e.querySelector(".technologies-item__image"),
          o = e.querySelector(".technologies-item__button"),
          s = e.querySelector(".technologies-item__left"),
          n = e.querySelector(".technologies-item__right"),
          r = e.querySelector(".technologies-item__top");
      window.innerWidth < 1024 && (n.append(i), n.append(l), s.append(o), r.append(t));
  });
  let L = document.querySelectorAll(".tests-menu__item"),
      E = document.querySelectorAll(".tests-menu__progress-bar .progress"),
      _ = document.querySelector(".tests-menu"),
      S = null,
      x = !1;
  function A() {
      let e = document.querySelectorAll(".slider__item .swiper-slide"),
          t = 0;
      e.forEach((e) => {
          e.style.height = "auto";
          let l = e.offsetHeight;
          l > t && (t = l);
      }),
          e.forEach((e) => {
              e.style.height = `${t}px`;
          });
  }
  function q() {
      return "ontouchstart" in window || navigator.maxTouchPoints > 0;
  }
  q() &&
      document.querySelectorAll(".zoomable").forEach((e) => {
          let t = 1,
              l = 0,
              i = 0,
              o = 0,
              s = 0,
              n = 0,
              r = 0,
              a = 0,
              c = !1;
          function d(e, t) {
              return Math.sqrt(Math.pow(t.clientX - e.clientX, 2) + Math.pow(t.clientY - e.clientY, 2));
          }
          e.addEventListener("touchstart", function (e) {
              2 === e.touches.length ? (l = d(e.touches[0], e.touches[1])) : 1 === e.touches.length && t > 1 && ((c = !0), (i = e.touches[0].clientX - r), (o = e.touches[0].clientY - a));
          }),
              e.addEventListener("touchmove", function (r) {
                  if (2 === r.touches.length) {
                      r.preventDefault();
                      let a = d(r.touches[0], r.touches[1]),
                          p = t * (a / l);
                      (t = Math.max(1, Math.min(3, p))), (e.style.transform = `scale(${t}) translate(${s}px, ${n}px)`), (l = a);
                  } else 1 === r.touches.length && c && (r.preventDefault(), (s = r.touches[0].clientX - i), (n = r.touches[0].clientY - o), (e.style.transform = `scale(${t}) translate(${s}px, ${n}px)`));
              }),
              e.addEventListener("touchend", function () {
                  (c = !1), (r = s), (a = n);
              });
      });
  let b = 5e3,
      w = null,
      P = new IntersectionObserver(
          (e, t) => {
              e.forEach((e) => {
                  e.isIntersecting &&
                      !x &&
                      ((x = !0),
                      A(),
                      (S = new Swiper(".slider__item", {
                          direction: "vertical",
                          loop: !1,
                          slidesPerView: 1,
                          spaceBetween: 50,
                          speed: 800,
                          autoplay: { delay: 5e3, disableOnInteraction: !1 },
                          breakpoints: { 767: { direction: "vertical" }, 0: { direction: "horizontal", spaceBetween: 15, slidesPerView: 1.188 } },
                          on: {
                              slideChange: function () {
                                  I(this);
                              },
                              loopFix: function () {
                                  I(this, this.realIndex);
                              },
                          },
                      })),
                      I(S),
                      window.addEventListener("resize", A),
                      t.disconnect());
              });
          },
          { root: null, rootMargin: "0px 0px -476px 0px", threshold: 0 }
      ),
      k = document.querySelector(".slider__item");
  function I(e, t = null) {
      if (!e) return;
      let l = null !== t ? t : e.realIndex,
          i = window.innerWidth <= 1024;
      e.activeIndex >= e.slides.length - e.loopedSlides ? (l = 0) : e.activeIndex < e.loopedSlides && (l = L.length - 1),
          E.forEach((e) => {
              (e.style.transition = "none"), i ? ((e.style.width = "0%"), (e.style.height = "")) : ((e.style.height = "0%"), (e.style.width = ""));
          }),
          E.forEach((e, t) => {
              t < l
                  ? ((e.style.transition = "none"), i ? ((e.style.width = "100%"), (e.style.height = "")) : ((e.style.height = "100%"), (e.style.width = "")), L[t].classList.add("completed"))
                  : t === l
                  ? (setTimeout(() => {
                        (e.style.transition = i ? "width 5s linear" : "height 5s linear"), i ? ((e.style.width = "100%"), (e.style.height = "")) : ((e.style.height = "100%"), (e.style.width = ""));
                    }, 50),
                    L[t].classList.add("completed"))
                  : L[t].classList.remove("completed");
          }),
          L.forEach((e, t) => {
              e.classList.toggle("active", t === l), t === l && i && (_.scrollLeft = e.offsetLeft);
          });
  }
  function Y() {
      if (!S) return;
      let e = window.innerWidth <= 1024,
          t = S.realIndex,
          l = E[t];
      if (l) {
          let i = window.getComputedStyle(l),
              o,
              s;
          e ? ((o = parseFloat(i.width)), (s = l.parentElement.clientWidth)) : ((o = parseFloat(i.height)), (s = l.parentElement.clientHeight));
          let n = (o / s) * 100;
          (l.style.transition = "none"), e ? (l.style.width = n + "%") : (l.style.height = n + "%"), (l.dataset.progressPercent = n), (b = 5e3 - (n / 100) * 5e3);
      }
  }
  function B() {
      if (!S) return;
      let e = window.innerWidth <= 1024,
          t = S.realIndex,
          l = E[t];
      if (l && void 0 !== l.dataset.progressPercent) {
          let i = parseFloat(l.dataset.progressPercent),
              o = ((100 - i) / 100) * 5e3;
          (l.style.transition = e ? `width ${o}ms linear` : `height ${o}ms linear`), e ? (l.style.width = "100%") : (l.style.height = "100%"), delete l.dataset.progressPercent;
      }
  }
  k && P.observe(k),
      L.forEach((e, t) => {
          e.addEventListener("click", () => {
              S && (S.slideToLoop(t), I(S, t));
          });
      }),
      S &&
          S.on("loopFix", () => {
              I(S, S.realIndex);
          }),
      x && (L[0].classList.add("completed"), I(S));
  let C = document.querySelectorAll(".popup-link"),
      W = document.querySelector("body"),
      D = document.querySelectorAll(".lock-padding"),
      R = !0;
  C.forEach((e) => {
      e.addEventListener("click", function (e) {
          e.preventDefault();
          let t = this.getAttribute("href").replace("#", ""),
              l = document.getElementById(t);
          l && (H(l), history.pushState(null, null, window.location.pathname));
      });
  });
  let T = document.querySelectorAll(".close-popup");
  function H(e) {
      if (e && R) {
          let t = document.querySelector(".popup.open");
          if (t) O(t, !1);
          else {
              let l = window.innerWidth - document.querySelector(".wrapper").offsetWidth + "px";
              D.forEach((e) => {
                  e.style.paddingRight = l;
              }),
                  (W.style.paddingRight = l),
                  W.classList.add("_lock"),
                  (R = !1),
                  setTimeout(() => {
                      R = !0;
                  }, 500);
          }
          e.classList.add("open"),
              w && clearTimeout(w),
              S && S.autoplay && S.autoplay.stop(),
              Y(),
              q() && window.innerWidth < 1024 && X(e),
              e.addEventListener("click", function (e) {
                  e.target.closest(".popup__content") || O(e.target.closest(".popup"));
              });
      }
  }
  function O(e, t = !0) {
      R &&
          (e.classList.remove("open"),
          B(),
          (w = setTimeout(function () {
              S.slideNext(), S.autoplay.start(), I(S);
          }, b)),
          t &&
              (setTimeout(() => {
                  D.forEach((e) => {
                      e.style.paddingRight = "0px";
                  }),
                      (W.style.paddingRight = "0px"),
                      W.classList.remove("_lock");
              }, 500),
              (R = !1),
              setTimeout(() => {
                  R = !0;
              }, 500)));
  }
  function X(e) {
      let t = 0,
          l = 0,
          i = document.createElement("div");
      (i.style.position = "absolute"),
          (i.style.top = "0"),
          (i.style.left = "0"),
          (i.style.width = "100%"),
          (i.style.height = "50px"),
          (i.style.zIndex = "10"),
          e.querySelector(".popup__content").prepend(i),
          i.addEventListener("touchstart", function (e) {
              t = e.touches[0].clientY;
          }),
          i.addEventListener("touchmove", function (i) {
              (l = i.touches[0].clientY) - t > 50 && O(e);
          });
  }
  T.forEach((e) => {
      e.addEventListener("click", function (e) {
          O(this.closest(".popup")), e.preventDefault();
      });
  }),
      document.addEventListener("keydown", function (e) {
          "Escape" === e.key && O(document.querySelector(".popup.open"));
      });
  let z = document.querySelectorAll("section")[2],
      M = window.scrollY;
  function V(e) {
      e.classList.toggle("_active"), e.parentElement.classList.toggle("_active");
  }
  function F(e) {
      e.classList.remove("_active"), e.parentElement.classList.remove("_active");
  }
  window.addEventListener("scroll", () => {
      let t = window.scrollY;
      t >= z.getBoundingClientRect().top + window.scrollY ? (t > M ? e.classList.add("_hidden") : (e.classList.remove("_hidden"), e.classList.add("fixed"))) : (e.classList.remove("_hidden"), e.classList.remove("fixed")), (M = t);
  });
});
